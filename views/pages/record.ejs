<%- include('../partials/head') -%> <%- include('../partials/header') -%>

<div class="singleView_page">
  <div class="singleView_wrapper container mt-5">
    <h3>The Best Car Deals</h3>

    <div class="btn_group mt-3 mb-3">
      <% if(admin) { %>
      <div class="create_btn">
        <a href="/addarecord" class="btn btn-info text-white"> Add a record </a>
      </div>
      <% } %>
    </div>

    <div class="table_wrapper table-responsive">
      <table class="table table-bordered">
        <thead>
          <tr>
            <th scope="col">ID</th>
            <th scope="col">Sales Person</th>
            <th scope="col">Customer Name</th>
            <th scope="col">Car Make</th>
            <th scope="col">Car Model</th>
            <th scope="col">Car Year</th>
            <th scope="col">Sale Price</th>
            <th scope="col">Comission Rate</th>
            <th scope="col">Comission Earned</th>
            <th scope="col">Created At</th>
            <th scope="col">Updated At</th>
          </tr>
        </tr>

        <%  
        
          records.forEach(record => {
            
        %>

            <tr>
                <td><%=  record._id  %></td>
                <td><%=  record.salesperson  %></td>
                <td><%=  record.customername  %></td>
                <td><%=  record.carmake %></td>
                <td><%=  record.carmodel %></td>
                <td><%=  record.caryear %></td>
                <td><%=  record.saleprice %></td>
                <td><%=  record.comissionrate %></td>
                <td><%=  record.comissionearned %></td>
                <td><%=  record.createdAt %></td>
                <td><%=  record.updatedAt %></td>
                <% if(admin) { %>
                <td class="text-center"><a class='btn btn-info btn-xs' href="/updatearecord/<%= record._id %>" ><span class="glyphicon glyphicon-edit"></span> Edit</a> 
                  <a  href="/viewrecords/delete/<%= record._id %>" class="btn btn-danger btn-xs"><span class="glyphicon glyphicon-remove"></span> Delete</a></td>
                  <% } %>
                

            </tr>
            
         <%  
           })
         %>
          
    </thead>
      </table>
      <div class="row col-md-12 col-md-offset-2 custyle mx-auto">
    
    
    
        <nav aria-label="Page navigation">
       
       
       
          <ul class="pagination">
  
            <% if (currentPage === 1) { %>
              
              <li class="page-item disabled"><a class="page-link" href="#">1</a></li>     
            <% } %>  
            <% if (currentPage > 1) { %>
                <li class="page-item"><a class="page-link" href="/viewrecords">1</a></li>
            <% } %>  
  
              <li class="page-item"><a class="page-link" href="/viewrecords?page=<%= currentPage === numberOfPages ? currentPage - 10 :  currentPage + 1 %>"><%= currentPage === numberOfPages ? currentPage - 10 :  currentPage + 1 %></a></li>
              <li class="page-item"><a class="page-link" href="/viewrecords?page=<%= currentPage === numberOfPages ? currentPage - 9 :  currentPage + 2 %>"><%= currentPage === numberOfPages ? currentPage - 9 :  currentPage + 2 %></a></li>
              <li class="page-item"><a class="page-link" href="/viewrecords?page=<%= currentPage === numberOfPages ? currentPage - 8 :  currentPage + 3 %>"><%= currentPage === numberOfPages ? currentPage - 8 :  currentPage + 3 %></a></li>
              <li class="page-item"><a class="page-link" href="/viewrecords?page=<%= currentPage === numberOfPages ? currentPage - 7 :  currentPage + 4 %>"><%= currentPage === numberOfPages ? currentPage - 7 :  currentPage + 4 %></a></li>
              <li class="page-item"><a class="page-link" href="/viewrecords?page=<%= currentPage === numberOfPages ? currentPage - 6 :  currentPage + 5 %>"><%= currentPage === numberOfPages ? currentPage - 6 :  currentPage + 5 %></a></li>
              <li class="page-item"><a class="page-link" href="/viewrecords?page=<%= currentPage === numberOfPages ? currentPage - 5 :  currentPage + 6 %>"><%= currentPage === numberOfPages ? currentPage - 5 :  currentPage + 6 %></a></li>
              <li class="page-item"><a class="page-link" href="/viewrecords?page=<%= currentPage === numberOfPages ? currentPage - 4 :  currentPage + 7 %>"><%= currentPage === numberOfPages ? currentPage - 4 :  currentPage + 7 %></a></li>
              <li class="page-item"><a class="page-link" href="/viewrecords?page=<%= currentPage === numberOfPages ? currentPage - 3 :  currentPage + 8 %>"><%= currentPage === numberOfPages ? currentPage - 3 :  currentPage + 8 %></a></li>
              <li class="page-item"><a class="page-link" href="/viewrecords?page=<%= currentPage === numberOfPages ? currentPage - 2 :  currentPage + 9 %>"><%= currentPage === numberOfPages ? currentPage - 2 :  currentPage + 9 %></a></li>
              <li class="page-item"><a class="page-link" href="/viewrecords?page=<%= currentPage === numberOfPages ? currentPage - 1 :  currentPage + 10 %>"><%= currentPage === numberOfPages ? currentPage - 1 :  currentPage + 10 %></a></li>
          
            <% if (currentPage === numberOfPages) { %>
              
              <li class="page-item disabled"><a class="page-link" href="">Last</a></li>     
            <% } %>  
            
            <% if (currentPage < numberOfPages) { %>
                <li class="page-item"><a class="page-link" href="/viewrecords?page=<%= numberOfPages %>">Last</a></li>
            <% } %>  
            
            </ul>
    </nav>
      </div>

    </div>
  </div>
</div>

<%- include('../partials/footer') %>
